
셀프 어텐션은 입력 시퀀스의 다른 위치에 있는 단어들을 둘러보면서 특정 위치의 단어를 잘 설명/표현 할 수 있게 함.


# 셀프 어텐션 절차

## Step1: 입력 벡터에 대해 세가지 벡터를 생성(Query, Key, Value)

![[Pasted image 20240626111112.png]]

## Step2: 지금 표현하고자 하는 단어(Q)에 대해 어떤 단어들을 고려해야 하는지(K)를 알려주는 스코어 산출

- Q와 K를 곱한 후 소프트맥스 함수를 취해서 이 스코어를 계산
![[Pasted image 20240626111720.png]]

## Step3: Step2에서 계산한 스코어를 $\sqrt{d_{k}}$로 나눠줌

## Step4: Step3의 결과물을 이용해서 [[소프트맥스 함수]]를 적용하여 해당 단어에 대한 집중도를 산출

![[Pasted image 20240626112441.png]]

## Step5: Step4에서 산출된 확률값과 해당 단어의 Key 값을 곱함
## Step6: Step5에서 산출된 모든 값들을 더해서 출력으로 반환
![[Pasted image 20240626141937.png]]

# 예시

![[Pasted image 20240626144305.png]]
![[Pasted image 20240626144516.png]]
![[Pasted image 20240626144525.png]]
![[Pasted image 20240626144532.png]]
- 동일한 작업을 모든 입력  토큰에 대해 각각 수행
